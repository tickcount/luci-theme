"use strict";"require baseclass";"require ui";return baseclass.extend({__init__(){ui.menu.load().then(tree=>this.render(tree));this.initMobileMenu();this.initUciIndicator();this.initVercelTabs();this.initTabContentAnimation();this.initCustomSelects();this.initDescriptionPlacement();this.initTableOfContents();this.initToastAutoDismiss()},initUciIndicator(){const original=ui.changes?.setIndicator;if(!original)return;ui.changes.setIndicator=function(n){original.call(this,n);document.querySelector('[data-indicator="uci-changes"]')?.setAttribute("data-count",n||0)}},initToastAutoDismiss(){const DISMISS_DELAY=3e4;const container=document.getElementById("maincontent");if(!container)return;const updateIndices=()=>{const toasts=container.querySelectorAll(":scope > .alert-message:not(.toast-exit)");toasts.forEach((t,i)=>{t.style.setProperty("--toast-index",i)})};const dismissToast=toast=>{if(toast._toastDismissing)return;toast._toastDismissing=true;if(toast._toastTimer)clearTimeout(toast._toastTimer);toast.classList.add("toast-exit");toast.addEventListener("animationend",()=>{toast.remove();updateIndices()},{once:true});setTimeout(()=>{if(toast.parentNode){toast.remove();updateIndices()}},400)};const setupToast=toast=>{if(toast._toastInit)return;toast._toastInit=true;updateIndices();toast._toastTimer=setTimeout(()=>dismissToast(toast),DISMISS_DELAY);const btn=toast.querySelector(".btn");if(btn){btn.addEventListener("click",e=>{e.preventDefault();e.stopPropagation();dismissToast(toast)})}};new MutationObserver(mutations=>{for(const m of mutations){for(const node of m.addedNodes){if(node.nodeType===1&&node.classList?.contains("alert-message")&&node.parentNode===container){setupToast(node)}}}}).observe(container,{childList:true});container.querySelectorAll(":scope > .alert-message").forEach(setupToast)},initVercelTabs(){const bindTabMenu=tabMenu=>{const items=Array.from(tabMenu.querySelectorAll("li"));if(!items.length)return;let activeReady=false;const updateActiveIndicator=()=>{const active=tabMenu.querySelector("li.cbi-tab");if(!active)return;const menuRect=tabMenu.getBoundingClientRect();const activeRect=active.getBoundingClientRect();if(!activeReady){tabMenu.classList.add("tab-active-jump");void tabMenu.offsetWidth}tabMenu.style.setProperty("--tab-active-left",`${activeRect.left-menuRect.left}px`);tabMenu.style.setProperty("--tab-active-width",`${activeRect.width}px`);tabMenu.style.setProperty("--tab-active-top",`${activeRect.bottom-menuRect.top}px`);if(!activeReady){void tabMenu.offsetWidth;tabMenu.classList.remove("tab-active-jump");activeReady=true}};let lastHoverTop=null;let hoverHideTimer=null;const updateHoverIndicator=li=>{if(!li){hoverHideTimer=setTimeout(()=>{tabMenu.classList.remove("tab-hovering");lastHoverTop=null},80);return}if(hoverHideTimer){clearTimeout(hoverHideTimer);hoverHideTimer=null}const menuRect=tabMenu.getBoundingClientRect();const liRect=li.getBoundingClientRect();const newTop=liRect.top-menuRect.top;const needsJump=lastHoverTop===null||lastHoverTop!==null&&Math.abs(newTop-lastHoverTop)>2;if(needsJump){tabMenu.classList.add("tab-hover-jump");void tabMenu.offsetWidth}tabMenu.style.setProperty("--tab-hover-left",`${liRect.left-menuRect.left}px`);tabMenu.style.setProperty("--tab-hover-width",`${liRect.width}px`);tabMenu.style.setProperty("--tab-hover-top",`${newTop}px`);tabMenu.classList.add("tab-hovering");if(needsJump){void tabMenu.offsetWidth;tabMenu.classList.remove("tab-hover-jump")}lastHoverTop=newTop};items.forEach(li=>{li.addEventListener("mouseenter",()=>updateHoverIndicator(li))});tabMenu.addEventListener("mouseleave",()=>updateHoverIndicator(null));const observer=new MutationObserver(updateActiveIndicator);items.forEach(li=>observer.observe(li,{attributes:true,attributeFilter:["class"]}));requestAnimationFrame(updateActiveIndicator);let resizeTimer;window.addEventListener("resize",()=>{clearTimeout(resizeTimer);resizeTimer=setTimeout(updateActiveIndicator,100)})};const waitForTabs=new MutationObserver(()=>{document.querySelectorAll(".cbi-tabmenu").forEach(menu=>{if(menu.dataset.vercelInit)return;menu.dataset.vercelInit="1";bindTabMenu(menu)})});const target=document.getElementById("maincontent")||document.body;waitForTabs.observe(target,{childList:true,subtree:true});document.querySelectorAll(".cbi-tabmenu").forEach(menu=>{menu.dataset.vercelInit="1";bindTabMenu(menu)})},initNavHover(){const nav=document.querySelector("#topmenu");if(!nav)return;const items=Array.from(nav.querySelectorAll(":scope > li"));if(!items.length)return;let hideTimer=null;let hasHovered=false;const show=li=>{if(hideTimer){clearTimeout(hideTimer);hideTimer=null}const navRect=nav.getBoundingClientRect();const liRect=li.getBoundingClientRect();if(!hasHovered){nav.classList.add("nav-hover-jump");void nav.offsetWidth}nav.style.setProperty("--nav-hover-left",`${liRect.left-navRect.left}px`);nav.style.setProperty("--nav-hover-width",`${liRect.width}px`);nav.classList.add("nav-hovering");if(!hasHovered){void nav.offsetWidth;nav.classList.remove("nav-hover-jump");hasHovered=true}};const hide=()=>{hideTimer=setTimeout(()=>{nav.classList.remove("nav-hovering");hasHovered=false},80)};items.forEach(li=>{li.addEventListener("mouseenter",()=>show(li))});nav.addEventListener("mouseleave",hide)},initTabContentAnimation(){const target=document.getElementById("maincontent")||document.body;let animating=false;target.addEventListener("click",e=>{const link=e.target.closest(".cbi-tabmenu li a");if(!link||animating||e._tabAnimBypass)return;const clickedLi=link.closest("li");if(clickedLi?.classList.contains("cbi-tab"))return;const tabMenu=link.closest(".cbi-tabmenu");const section=tabMenu?.closest(".cbi-section, .cbi-map");const activePanel=section?.querySelector("[data-tab-active='true'][data-tab-title]");if(!activePanel)return;e.stopPropagation();e.preventDefault();animating=true;activePanel.classList.add("tab-content-exit");activePanel.addEventListener("animationend",()=>{activePanel.classList.remove("tab-content-exit");animating=false;const bypass=new MouseEvent("click",{bubbles:true});bypass._tabAnimBypass=true;link.dispatchEvent(bypass)},{once:true})},true);new MutationObserver(mutations=>{mutations.forEach(m=>{if(m.type==="attributes"&&m.attributeName==="data-tab-active"&&m.target.getAttribute("data-tab-active")==="true"&&m.target.hasAttribute("data-tab-title")){m.target.classList.remove("tab-content-enter");void m.target.offsetWidth;m.target.classList.add("tab-content-enter");m.target.addEventListener("animationend",()=>m.target.classList.remove("tab-content-enter"),{once:true})}})}).observe(target,{subtree:true,attributes:true,attributeFilter:["data-tab-active"]});const ro=new ResizeObserver(entries=>{for(const entry of entries){const el=entry.target;if(el._htLock)continue;const newH=Math.round(entry.borderBoxSize[0].blockSize);const oldH=el._htPrev;el._htPrev=newH;if(oldH===undefined||oldH===newH)continue;el._htLock=true;el.classList.add("tab-height-anim");el.style.height=oldH+"px";void el.offsetWidth;el.style.height=newH+"px";const done=()=>{el.classList.remove("tab-height-anim");el.style.height="";el._htLock=false};const onEnd=e=>{if(e.propertyName!=="height")return;el.removeEventListener("transitionend",onEnd);clearTimeout(tid);done()};el.addEventListener("transitionend",onEnd);const tid=setTimeout(()=>{el.removeEventListener("transitionend",onEnd);done()},500)}});const watch=c=>{if(c._htWatched)return;c._htWatched=true;ro.observe(c)};target.querySelectorAll(".cbi-section-node-tabbed, .cbi-map-tabbed").forEach(watch);const watchView=v=>{if(v._viewWatched)return;v._viewWatched=true;new MutationObserver(muts=>{for(const m of muts){for(const n of m.removedNodes){if(!n.classList?.contains("spinning"))continue;v.classList.remove("tab-content-enter");void v.offsetWidth;v.classList.add("tab-content-enter");v.addEventListener("animationend",()=>v.classList.remove("tab-content-enter"),{once:true});return}}}).observe(v,{childList:true})};const view=document.getElementById("view");if(view)watchView(view);new MutationObserver(muts=>{for(const m of muts){for(const n of m.addedNodes){if(n.nodeType!==1)continue;if(n.matches?.(".cbi-section-node-tabbed, .cbi-map-tabbed"))watch(n);n.querySelectorAll?.(".cbi-section-node-tabbed, .cbi-map-tabbed").forEach(watch);if(n.id==="view")watchView(n)}}}).observe(target,{childList:true,subtree:true})},initDescriptionPlacement(){const move=()=>{document.querySelectorAll(".cbi-value-field > .cbi-value-description").forEach(desc=>{if(desc._aurMoved)return;desc._aurMoved=true;const row=desc.closest(".cbi-value");if(!row)return;const title=row.querySelector(".cbi-value-title");if(title){title.appendChild(desc)}})};move();const target=document.getElementById("maincontent")||document.body;new MutationObserver(()=>requestAnimationFrame(move)).observe(target,{childList:true,subtree:true})},closeAllDropdowns(except){document.querySelectorAll(".outline-select.open").forEach(s=>{if(s!==except)s.classList.remove("open")});document.querySelectorAll(".cbi-dropdown[open]").forEach(d=>{if(d!==except)d.removeAttribute("open")})},initCustomSelects(){const replace=sel=>{if(sel._outlineReplaced||sel.closest(".outline-select"))return;sel._outlineReplaced=true;const opts=Array.from(sel.options);if(!opts.length)return;const wrap=document.createElement("div");wrap.className="outline-select";wrap.tabIndex=0;if(sel.disabled)wrap.classList.add("disabled");const trigger=document.createElement("div");trigger.className="outline-select-trigger";const val=document.createElement("span");val.className="outline-select-value";val.textContent=sel.options[sel.selectedIndex]?.text||"";const chevron=document.createElement("span");chevron.className="outline-select-chevron";trigger.append(val,chevron);const panel=document.createElement("div");panel.className="outline-select-panel";const buildOptions=()=>{panel.innerHTML="";Array.from(sel.options).forEach(opt=>{const item=document.createElement("div");item.className="outline-select-option"+(opt.index===sel.selectedIndex?" selected":"");item.dataset.value=opt.value;item.dataset.index=opt.index;item.textContent=opt.text;item.addEventListener("click",e=>{e.stopPropagation();sel.selectedIndex=opt.index;sel.dispatchEvent(new Event("change",{bubbles:true}));val.textContent=opt.text;panel.querySelectorAll(".selected").forEach(o=>o.classList.remove("selected"));item.classList.add("selected");close()});panel.appendChild(item)})};buildOptions();wrap.append(trigger,panel);sel.style.display="none";sel.insertAdjacentElement("afterend",wrap);let isOpen=false;const open=()=>{if(isOpen||sel.disabled)return;this.closeAllDropdowns(wrap);isOpen=true;wrap.classList.add("open");const rect=wrap.getBoundingClientRect();const below=window.innerHeight-rect.bottom;panel.classList.toggle("above",below<200&&rect.top>200);const cur=panel.querySelector(".selected");if(cur)cur.scrollIntoView({block:"nearest"})};const close=()=>{if(!isOpen)return;isOpen=false;wrap.classList.remove("open")};trigger.addEventListener("click",e=>{e.stopPropagation();isOpen?close():open()});document.addEventListener("click",e=>{if(!wrap.contains(e.target))close()});wrap.addEventListener("keydown",e=>{if(e.key==="Enter"||e.key===" "){e.preventDefault();isOpen?close():open()}else if(e.key==="Escape"){close()}else if(e.key==="ArrowDown"||e.key==="ArrowUp"){e.preventDefault();const items=Array.from(panel.querySelectorAll(".outline-select-option"));const cur=panel.querySelector(".outline-select-option.selected");const idx=items.indexOf(cur);const next=e.key==="ArrowDown"?Math.min(idx+1,items.length-1):Math.max(idx-1,0);if(items[next])items[next].click()}});new MutationObserver(()=>{val.textContent=sel.options[sel.selectedIndex]?.text||"";buildOptions()}).observe(sel,{attributes:true,childList:true,subtree:true})};const replaceAll=()=>{document.querySelectorAll("select").forEach(replace)};replaceAll();document.addEventListener("click",e=>{const openBtn=e.target.closest(".cbi-dropdown > .open");if(openBtn){this.closeAllDropdowns(openBtn.closest(".cbi-dropdown"))}});const target=document.getElementById("maincontent")||document.body;new MutationObserver(()=>{requestAnimationFrame(replaceAll)}).observe(target,{childList:true,subtree:true})},initMobileMenu(){const overlay=document.querySelector("#mobile-menu-overlay");const menuToggle=document.querySelector("#mobile-menu-btn");const closeBtn=document.querySelector("#mobile-nav-close");if(!menuToggle||!overlay)return;menuToggle.addEventListener("click",e=>{e.stopPropagation();const isOpen=overlay.classList.contains("mobile-menu-open");overlay.classList.toggle("mobile-menu-open",!isOpen);menuToggle.classList.toggle("active",!isOpen);menuToggle.setAttribute("aria-expanded",!isOpen);document.body.style.overflow=isOpen?"":"hidden";if(isOpen){overlay.querySelectorAll(".sidebar-section").forEach(sec=>{const hasActive=sec.querySelector(".sidebar-link.active");sec.classList.toggle("expanded",!!hasActive)})}});if(closeBtn){closeBtn.addEventListener("click",()=>menuToggle.click())}overlay.addEventListener("click",e=>{if(e.target===overlay)menuToggle.click()});document.addEventListener("keydown",e=>{if(e.key==="Escape"&&overlay.classList.contains("mobile-menu-open")){menuToggle.click()}})},renderMobileMenu(tree,url){const list=document.querySelector("#mobile-nav-list");const children=ui.menu.getChildren(tree);if(!list||!children.length)return;list.innerHTML="";const sectionList=E("ul",{class:"sidebar-sections"});children.forEach(category=>{const subItems=ui.menu.getChildren(category);if(!subItems.length)return;const hasActive=category.name===L.env.dispatchpath[1];const chevron=document.createElementNS("http://www.w3.org/2000/svg","svg");chevron.setAttribute("viewBox","0 0 16 16");chevron.setAttribute("width","16");chevron.setAttribute("height","16");chevron.setAttribute("fill","currentColor");chevron.classList.add("sidebar-chevron");const path=document.createElementNS("http://www.w3.org/2000/svg","path");path.setAttribute("d","M4.646 5.646a.5.5 0 0 1 .708 0L8 8.293l2.646-2.647a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 0 1 0-.708z");chevron.appendChild(path);const toggle=E("button",{class:"sidebar-toggle"+(hasActive?" active":"")},[_(category.title),chevron]);const ul=E("ul",{class:"sidebar-list"});subItems.forEach(child=>{const itemUrl=L.url(url,category.name,child.name);const isActive=category.name===L.env.dispatchpath[1]&&child.name===L.env.dispatchpath[2];ul.appendChild(E("li",{class:"sidebar-item"+(isActive?" active":"")},[E("a",{class:"sidebar-link"+(isActive?" active":""),href:itemUrl},[_(child.title)])]))});const listWrapper=E("div",{class:"sidebar-list-wrapper"},[ul]);const section=E("li",{class:"sidebar-section"+(hasActive?" expanded":"")},[toggle,listWrapper]);toggle.addEventListener("click",()=>{section.classList.toggle("expanded")});sectionList.appendChild(section)});list.appendChild(sectionList)},render(tree){this.renderModeMenu(tree);if(L.env.dispatchpath.length>=3){let node=tree;let url="";for(let i=0;i<3&&node;i++){const segment=L.env.dispatchpath[i];node=node.children?.[segment];url+=(url?"/":"")+segment}if(node)this.renderTabMenu(node,url)}},renderTabMenu(tree,url,level=0){const container=document.querySelector("#tabmenu");const ul=E("ul",{class:"tabs"});const children=ui.menu.getChildren(tree);let activeNode=null;children.forEach(child=>{const isActive=L.env.dispatchpath[3+level]===child.name;ul.appendChild(E("li",{class:`tabmenu-item-${child.name}${isActive?" active":""}`},[E("a",{href:L.url(url,child.name)},[_(child.title)])]));if(isActive)activeNode=child});if(!ul.children.length)return E([]);container.appendChild(ul);container.style.display="";if(activeNode){this.renderTabMenu(activeNode,`${url}/${activeNode.name}`,level+1)}return ul},renderMainMenu(tree,url){const sidebar=document.querySelector("#sidebar");const children=ui.menu.getChildren(tree);if(!children.length||!sidebar)return;this.renderFullSidebar(children,url,sidebar)},renderFullSidebar(categories,baseUrl,sidebar){const nav=E("nav",{class:"sidebar-nav"});const sectionList=E("ul",{class:"sidebar-sections"});categories.forEach(category=>{const subItems=ui.menu.getChildren(category);if(!subItems.length)return;const hasActive=category.name===L.env.dispatchpath[1];const chevron=document.createElementNS("http://www.w3.org/2000/svg","svg");chevron.setAttribute("viewBox","0 0 16 16");chevron.setAttribute("width","16");chevron.setAttribute("height","16");chevron.setAttribute("fill","currentColor");chevron.classList.add("sidebar-chevron");const path=document.createElementNS("http://www.w3.org/2000/svg","path");path.setAttribute("d","M4.646 5.646a.5.5 0 0 1 .708 0L8 8.293l2.646-2.647a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 0 1 0-.708z");chevron.appendChild(path);const toggle=E("button",{class:"sidebar-toggle"+(hasActive?" active":"")},[_(category.title),chevron]);const ul=E("ul",{class:"sidebar-list"});subItems.forEach(child=>{const isActive=category.name===L.env.dispatchpath[1]&&child.name===L.env.dispatchpath[2];ul.appendChild(E("li",{class:"sidebar-item"+(isActive?" active":"")},[E("a",{class:"sidebar-link"+(isActive?" active":""),href:L.url(baseUrl,category.name,child.name)},[_(child.title)])]))});const listWrapper=E("div",{class:"sidebar-list-wrapper"},[ul]);const section=E("li",{class:"sidebar-section"+(hasActive?" expanded":"")},[toggle,listWrapper]);toggle.addEventListener("click",()=>{section.classList.toggle("expanded")});sectionList.appendChild(section)});nav.appendChild(sectionList);sidebar.appendChild(nav);const syncLeft=()=>{nav.style.left=sidebar.getBoundingClientRect().left+"px"};syncLeft();window.addEventListener("resize",syncLeft)},initTableOfContents(){const tocContainer=document.querySelector("#toc-container");if(!tocContainer)return;let scrollCleanup=null;let prevKey="";const buildToc=()=>{const sections=document.querySelectorAll("#view .cbi-section:not([data-tab-title]) > .cbi-title > h3, #view .cbi-section:not([data-tab-title]) > h3");const key=Array.from(sections,h=>h.textContent.trim()).join("|");if(key===prevKey)return;prevKey=key;if(sections.length<2){tocContainer.innerHTML="";if(scrollCleanup)scrollCleanup();return}tocContainer.innerHTML="";const tocIcon=document.createElementNS("http://www.w3.org/2000/svg","svg");tocIcon.setAttribute("width","16");tocIcon.setAttribute("height","16");tocIcon.setAttribute("viewBox","0 0 16 16");tocIcon.setAttribute("fill","none");tocIcon.innerHTML='<path d="M2 4h12M2 8h12M2 12h12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>';const heading=E("div",{class:"toc-heading"},[tocIcon,"On this page"]);const list=E("ul",{class:"toc-list"});const sectionElements=[];sections.forEach((h3,i)=>{const id="section-"+i;const section=h3.closest(".cbi-section");if(section){section.id=id;sectionElements.push(section)}const text=h3.textContent.trim();const link=E("a",{class:"toc-link",href:"#"+id,"data-target":id},[text]);link.addEventListener("click",e=>{e.preventDefault();const section=document.getElementById(id);if(!section)return;const el=section.querySelector("h3")||section;const headerOffset=80;const targetY=el.getBoundingClientRect().top+window.scrollY-headerOffset;const startY=window.scrollY;const dist=targetY-startY;if(Math.abs(dist)<1)return;const dur=Math.min(600,200+Math.abs(dist)*.08);const t0=performance.now();const step=now=>{const p=Math.min((now-t0)/dur,1);const ease=1-Math.pow(1-p,3);window.scrollTo(0,startY+dist*ease);if(p<1)requestAnimationFrame(step)};requestAnimationFrame(step)});list.appendChild(E("li",{class:"toc-item"},[link]))});let tocInner=tocContainer.querySelector(".toc-inner");if(!tocInner){tocInner=E("div",{class:"toc-inner"});tocContainer.appendChild(tocInner);const syncTocLeft=()=>{tocInner.style.left=tocContainer.getBoundingClientRect().left+"px"};syncTocLeft();window.addEventListener("resize",syncTocLeft)}tocInner.innerHTML="";tocInner.appendChild(heading);tocInner.appendChild(list);const links=tocContainer.querySelectorAll(".toc-link");const headerOffset=80;const getSectionTop=el=>{let top=0;while(el){top+=el.offsetTop;el=el.offsetParent}return top};const updateActive=()=>{let activeIdx=0;const scrollY=window.scrollY+headerOffset+20;for(let i=sectionElements.length-1;i>=0;i--){const s=sectionElements[i];if(!s||s.offsetHeight===0)continue;if(getSectionTop(s)<=scrollY){activeIdx=i;break}}links.forEach((l,i)=>{l.classList.toggle("active",i===activeIdx)})};if(scrollCleanup)scrollCleanup();window.addEventListener("scroll",updateActive,{passive:true});scrollCleanup=()=>window.removeEventListener("scroll",updateActive);updateActive()};const target=document.querySelector(".docs-content")||document.getElementById("maincontent")||document.body;let rafId=null;new MutationObserver(()=>{if(rafId)cancelAnimationFrame(rafId);rafId=requestAnimationFrame(()=>{rafId=null;buildToc()})}).observe(target,{childList:true,subtree:true});requestAnimationFrame(buildToc)},renderModeMenu(tree){const ul=document.querySelector("#modemenu");const children=ui.menu.getChildren(tree);let activeChild=null;children.forEach((child,index)=>{const isActive=L.env.requestpath.length?child.name===L.env.requestpath[0]:index===0;ul.appendChild(E("li",{class:isActive?"active":""},[E("a",{href:L.url(child.name)},[_(child.title)])]));if(isActive)activeChild=child});if(activeChild){this.renderMainMenu(activeChild,activeChild.name);this.renderMobileMenu(activeChild,activeChild.name)}if(ul.children.length>1){ul.style.display=""}}});